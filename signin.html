<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Tickets - Sign Up</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .signup-container {
            background: rgba(26, 26, 46, 0.9);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 450px;
            text-align: center;
            border: 1px solid rgba(100, 255, 218, 0.2);
            backdrop-filter: blur(10px);
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: #64ffda;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(100, 255, 218, 0.3);
        }

        .subtitle {
            color: #8892b0;
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .form-group label {
            color: #ffb347;
            font-weight: 500;
            margin-bottom: 4px;
            display: block;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(100, 255, 218, 0.2);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background: rgba(15, 52, 96, 0.8);
            color: #e6f1ff;
        }

        .form-group input:focus {
            outline: none;
            border-color: #64ffda;
            box-shadow: 0 0 10px rgba(100, 255, 218, 0.3);
        }

        .form-group input.error {
            border-color: #ff6b6b;
        }

        .form-group input.success {
            border-color: #64ffda;
        }

        .form-group input::placeholder {
            color: #8892b0;
        }

        .error-message {
            color: #ff6b6b;
            font-size: 14px;
            margin-top: 0.5rem;
            display: none;
        }

        .success-message {
            color: #64ffda;
            font-size: 14px;
            margin-top: 0.5rem;
            display: none;
        }

        .password-strength {
            margin-top: 0.5rem;
            font-size: 12px;
        }

        .strength-bar {
            height: 4px;
            background: rgba(100, 255, 218, 0.2);
            border-radius: 2px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .strength-fill {
            height: 100%;
            transition: all 0.3s ease;
            width: 0%;
        }

        .strength-weak { background: #ff6b6b; }
        .strength-medium { background: #ffc107; }
        .strength-strong { background: #64ffda; }

        .signup-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #64ffda 0%, #00bcd4 100%);
            color: #0a192f;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .signup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(100, 255, 218, 0.4);
        }

        .signup-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .login-link {
            margin-top: 1.5rem;
            color: #8892b0;
        }

        .login-link span {
            color: #64ffda;
            cursor: pointer;
            text-decoration: underline;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .login-link span:hover {
            color: #00bcd4;
        }

        .terms-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .terms-checkbox input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .terms-checkbox label {
            margin-bottom: 0;
            font-size: 14px;
            color: #8892b0;
        }

        .terms-checkbox label a {
            color: #64ffda;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .terms-checkbox label a:hover {
            text-decoration: underline;
            color: #00bcd4;
        }

        .form-group select {
            background: #181a20;
            color: #f1f1f1;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 10px;
            font-size: 1rem;
            width: 100%;
            margin-bottom: 8px;
            transition: border 0.2s;
        }

        .form-group select:focus {
            border: 1.5px solid #ffb347;
            outline: none;
        }
    </style>
</head>
<body>
    <div class="signup-container">
        <div class="logo">ðŸŽ¬ Movie Tickets</div>
        <p class="subtitle">Create your account to get started!</p>
        
        <form id="signupForm">
            <div class="form-group">
                <label for="fullName">Full Name</label>
                <input type="text" id="fullName" name="fullName" placeholder="Enter your full name" required>
                <div class="error-message" id="fullNameError"></div>
            </div>
            
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Enter your email" required>
                <div class="error-message" id="emailError"></div>
            </div>
            
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Create a password" required>
                <div class="password-strength" id="passwordStrength">
                    <div class="strength-bar">
                        <div class="strength-fill" id="strengthFill"></div>
                    </div>
                </div>
                <div class="error-message" id="passwordError"></div>
            </div>
            
            <div class="form-group">
                <label for="confirmPassword">Confirm Password</label>
                <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm your password" required>
                <div class="error-message" id="confirmPasswordError"></div>
            </div>
            
            <div class="form-group">
                <label for="role">Role:</label>
                <select id="role" name="role" required>
                    <option value="user">User</option>
                    <option value="admin">Admin</option>
                </select>
            </div>
            
            <div class="terms-checkbox">
                <input type="checkbox" id="terms" name="terms" required>
                <label for="terms">I agree to the <a href="#" onclick="showTerms()">Terms of Service</a> and <a href="#" onclick="showPrivacy()">Privacy Policy</a></label>
            </div>
            
            <button type="submit" class="signup-btn" id="signupBtn">Create Account</button>
        </form>
        
        <div class="success-message" id="successMessage">Account created successfully! Redirecting to login...</div>
        
        <div class="login-link">
            Already have an account? <span onclick="navigateToLogin()">Login</span>
        </div>
    </div>

    <script>
        // Get DOM elements
        const signupForm = document.getElementById('signupForm');
        const fullNameInput = document.getElementById('fullName');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirmPassword');
        const termsCheckbox = document.getElementById('terms');
        const signupBtn = document.getElementById('signupBtn');
        const strengthFill = document.getElementById('strengthFill');
        const passwordStrength = document.getElementById('passwordStrength');
        const roleSelect = document.getElementById('role');

        // Error elements
        const fullNameError = document.getElementById('fullNameError');
        const emailError = document.getElementById('emailError');
        const passwordError = document.getElementById('passwordError');
        const confirmPasswordError = document.getElementById('confirmPasswordError');
        const successMessage = document.getElementById('successMessage');

        // Validation functions
        function validateFullName(name) {
            return name.trim().length >= 2 && /^[a-zA-Z\s]+$/.test(name.trim());
        }

        function validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function validatePassword(password) {
            return password.length >= 8;
        }

        function checkPasswordStrength(password) {
            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;
            
            return strength;
        }

        function updatePasswordStrength(password) {
            const strength = checkPasswordStrength(password);
            const strengthBar = strengthFill;
            
            if (strength <= 2) {
                strengthBar.className = 'strength-fill strength-weak';
                strengthBar.style.width = (strength * 20) + '%';
            } else if (strength <= 3) {
                strengthBar.className = 'strength-fill strength-medium';
                strengthBar.style.width = (strength * 20) + '%';
            } else {
                strengthBar.className = 'strength-fill strength-strong';
                strengthBar.style.width = (strength * 20) + '%';
            }
        }

        function showError(element, message) {
            element.style.display = 'block';
            element.textContent = message;
        }

        function hideError(element) {
            element.style.display = 'none';
            element.textContent = '';
        }

        function setInputError(input, hasError, isSuccess = false) {
            input.classList.remove('error', 'success');
            if (hasError) {
                input.classList.add('error');
            } else if (isSuccess) {
                input.classList.add('success');
            }
        }

        // Real-time validation
        fullNameInput.addEventListener('input', function() {
            const name = this.value.trim();
            if (name === '') {
                hideError(fullNameError);
                setInputError(this, false);
            } else if (!validateFullName(name)) {
                showError(fullNameError, 'Please enter a valid full name (letters and spaces only)');
                setInputError(this, true);
            } else {
                hideError(fullNameError);
                setInputError(this, false, true);
            }
        });

        emailInput.addEventListener('input', function() {
            const email = this.value.trim();
            if (email === '') {
                hideError(emailError);
                setInputError(this, false);
            } else if (!validateEmail(email)) {
                showError(emailError, 'Please enter a valid email address');
                setInputError(this, true);
            } else {
                hideError(emailError);
                setInputError(this, false, true);
            }
        });

        passwordInput.addEventListener('input', function() {
            const password = this.value;
            updatePasswordStrength(password);
            
            if (password === '') {
                hideError(passwordError);
                setInputError(this, false);
                strengthFill.style.width = '0%';
            } else if (!validatePassword(password)) {
                showError(passwordError, 'Password must be at least 8 characters long');
                setInputError(this, true);
            } else {
                hideError(passwordError);
                setInputError(this, false, true);
            }
        });

        confirmPasswordInput.addEventListener('input', function() {
            const password = passwordInput.value;
            const confirmPassword = this.value;
            
            if (confirmPassword === '') {
                hideError(confirmPasswordError);
                setInputError(this, false);
            } else if (password !== confirmPassword) {
                showError(confirmPasswordError, 'Passwords do not match');
                setInputError(this, true);
            } else {
                hideError(confirmPasswordError);
                setInputError(this, false, true);
            }
        });

        // Form submission
        signupForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const fullName = fullNameInput.value.trim();
            const email = emailInput.value.trim();
            const password = passwordInput.value;
            const confirmPassword = confirmPasswordInput.value;
            const termsAccepted = termsCheckbox.checked;
            const role = roleSelect.value;
            
            // Reset errors
            hideError(fullNameError);
            hideError(emailError);
            hideError(passwordError);
            hideError(confirmPasswordError);
            setInputError(fullNameInput, false);
            setInputError(emailInput, false);
            setInputError(passwordInput, false);
            setInputError(confirmPasswordInput, false);
            
            let isValid = true;
            
            // Validate full name
            if (fullName === '') {
                showError(fullNameError, 'Full name is required');
                setInputError(fullNameInput, true);
                isValid = false;
            } else if (!validateFullName(fullName)) {
                showError(fullNameError, 'Please enter a valid full name (letters and spaces only)');
                setInputError(fullNameInput, true);
                isValid = false;
            }
            
            // Validate email
            if (email === '') {
                showError(emailError, 'Email is required');
                setInputError(emailInput, true);
                isValid = false;
            } else if (!validateEmail(email)) {
                showError(emailError, 'Please enter a valid email address');
                setInputError(emailInput, true);
                isValid = false;
            }
            
            // Validate password
            if (password === '') {
                showError(passwordError, 'Password is required');
                setInputError(passwordInput, true);
                isValid = false;
            } else if (!validatePassword(password)) {
                showError(passwordError, 'Password must be at least 8 characters long');
                setInputError(passwordInput, true);
                isValid = false;
            }
            
            // Validate confirm password
            if (confirmPassword === '') {
                showError(confirmPasswordError, 'Please confirm your password');
                setInputError(confirmPasswordInput, true);
                isValid = false;
            } else if (password !== confirmPassword) {
                showError(confirmPasswordError, 'Passwords do not match');
                setInputError(confirmPasswordInput, true);
                isValid = false;
            }
            
            // Validate terms
            if (!termsAccepted) {
                alert('Please accept the Terms of Service and Privacy Policy');
                isValid = false;
            }
            
            if (isValid) {
                // Disable button and show loading
                signupBtn.disabled = true;
                signupBtn.textContent = 'Creating Account...';
                
                try {
                    // Call backend API to register user
                    let endpoint = '';
                    if (role === 'admin') {
                        endpoint = '/api/admins/register';
                    } else {
                        endpoint = '/api/users/register';
                    }
                    const response = await fetch(endpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            fullName: fullName,
                            email: email,
                            password: password
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        // Registration successful
                        successMessage.style.display = 'block';
                        signupBtn.textContent = 'Success!';
                        
                        // Store user info in localStorage for session management
                        localStorage.setItem('username', fullName);
                        localStorage.setItem('userEmail', email);
                        
                        // Redirect to login page after 2 seconds
                        setTimeout(() => {
                            window.location.href = 'login.html';
                        }, 2000);
                    } else {
                        // Registration failed
                        showError(emailError, data.message || 'Registration failed. Please try again.');
                        setInputError(emailInput, true);
                        signupBtn.disabled = false;
                        signupBtn.textContent = 'Sign Up';
                    }
                } catch (error) {
                    console.error('Registration error:', error);
                    showError(emailError, 'Network error. Please check your connection and try again.');
                    setInputError(emailInput, true);
                    signupBtn.disabled = false;
                    signupBtn.textContent = 'Sign Up';
                }
            }
        });

        // Navigation function
        function navigateToLogin() {
            window.location.href = 'login.html';
        }

        // Terms and Privacy functions
        function showTerms() {
            alert('Terms of Service:\n\n1. You must be 13 years or older to use this service.\n2. You are responsible for maintaining the security of your account.\n3. You agree not to use the service for any illegal purposes.\n4. We reserve the right to modify these terms at any time.');
        }

        function showPrivacy() {
            alert('Privacy Policy:\n\n1. We collect your email and name for account creation.\n2. Your data is stored securely and never shared with third parties.\n3. We use cookies to improve your experience.\n4. You can request deletion of your data at any time.');
        }

        // Add some interactive effects
        document.addEventListener('DOMContentLoaded', function() {
            // Add focus effects
            const inputs = document.querySelectorAll('input[type="text"], input[type="email"], input[type="password"]');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.parentElement.style.transform = 'scale(1.02)';
                });
                
                input.addEventListener('blur', function() {
                    this.parentElement.style.transform = 'scale(1)';
                });
            });
        });
    </script>
</body>
</html>
